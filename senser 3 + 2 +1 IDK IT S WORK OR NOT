// -----------------------------
// ðŸ”° Ultrasonic 3 Sensors System
// Sensor 1 + Sensor 2 = à¹à¸ªà¸”à¸‡à¸£à¸°à¸¢à¸°
// Sensor 3 = à¹€à¸•à¸·à¸­à¸™à¸”à¹‰à¸§à¸¢ Buzzer + LED
// -----------------------------

// --- Sensor 1 ---
const int trigPin1 = 13;
const int echoPin1 = 12;

// --- Sensor 2 ---
const int trigPin2 = A1;
const int echoPin2 = A0;

// --- Sensor 3 ---
const int trigPin3 = A1;
const int echoPin3 = A0;
const int buzzer = 18;
const int ledPin = 1;

// --- Variables ---
long duration1, duration2, duration3;
int distance1, distance2, distance3;

void setup() {
  Serial.begin(9600);

  // Sensor 1
  pinMode(trigPin1, OUTPUT);
  pinMode(echoPin1, INPUT);

  // Sensor 2
  pinMode(trigPin2, OUTPUT);
  pinMode(echoPin2, INPUT);

  // Sensor 3
  pinMode(trigPin3, OUTPUT);
  pinMode(echoPin3, INPUT);
  pinMode(buzzer, OUTPUT);
  pinMode(ledPin, OUTPUT);

  Serial.println("System Ready...");
}

void loop() {
  // -----------------------------
  // Sensor 1
  // -----------------------------
  digitalWrite(trigPin1, LOW);
  delayMicroseconds(2);
  digitalWrite(trigPin1, HIGH);
  delayMicroseconds(10);
  digitalWrite(trigPin1, LOW);
  duration1 = pulseIn(echoPin1, HIGH);
  distance1 = duration1 * 0.034 / 2;

  // -----------------------------
  // Sensor 2
  // -----------------------------
  digitalWrite(trigPin2, LOW);
  delayMicroseconds(2);
  digitalWrite(trigPin2, HIGH);
  delayMicroseconds(10);
  digitalWrite(trigPin2, LOW);
  duration2 = pulseIn(echoPin2, HIGH);
  distance2 = duration2 * 0.034 / 2;

  // -----------------------------
  // Sensor 3
  // -----------------------------
  digitalWrite(trigPin3, LOW);
  delayMicroseconds(2);
  digitalWrite(trigPin3, HIGH);
  delayMicroseconds(10);
  digitalWrite(trigPin3, LOW);
  duration3 = pulseIn(echoPin3, HIGH);
  distance3 = duration3 * 0.034 / 2;

  // -----------------------------
  // à¹à¸ªà¸”à¸‡à¸œà¸¥à¸—à¸¸à¸ Sensor
  // -----------------------------
  Serial.print("Sensor1: ");
  Serial.print(distance1);
  Serial.print(" cm\t");

  Serial.print("Sensor2: ");
  Serial.print(distance2);
  Serial.print(" cm\t");

  Serial.print("Sensor3: ");
  Serial.print(distance3);
  Serial.println(" cm");

  // -----------------------------
  // à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚à¹€à¸•à¸·à¸­à¸™à¸ªà¸³à¸«à¸£à¸±à¸š Sensor 1â€“2
  // -----------------------------
  if (distance1 > 0 && distance1 <= 300)
    Serial.println("âš ï¸ Sensor 1 detected object!");
  if (distance2 > 0 && distance2 <= 300)
    Serial.println("âš ï¸ Sensor 2 detected object!");

  // -----------------------------
  // à¸£à¸°à¸šà¸šà¹€à¸•à¸·à¸­à¸™à¸‚à¸­à¸‡ Sensor 3 (à¸¡à¸µ buzzer + LED)
  // -----------------------------
  if (distance3 > 0 && distance3 <= 30) {
    int delayTime = map(distance3, 0, 30, 50, 800); // à¸¢à¸´à¹ˆà¸‡à¹ƒà¸à¸¥à¹‰ à¸¢à¸´à¹ˆà¸‡à¸–à¸µà¹ˆ
    Serial.println("âš ï¸ Sensor 3 ALERT!");

    digitalWrite(ledPin, HIGH);
    digitalWrite(buzzer, HIGH);
    delay(100);

    digitalWrite(ledPin, LOW);
    digitalWrite(buzzer, LOW);
    delay(delayTime);
  } else {
    digitalWrite(buzzer, LOW);
    digitalWrite(ledPin, LOW);
  }

  // -----------------------------
  delay(300); // à¸«à¸™à¹ˆà¸§à¸‡à¸£à¸§à¸¡à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸£à¸­à¸š
}
